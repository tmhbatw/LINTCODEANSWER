package LINTCODE5;

import java.util.HashSet;
import java.util.PriorityQueue;
import java.util.Set;

public class LINTCODE465 {
    /*Description
    *给定两个排好序的数组 A, B 和一个整数k，定义集合 sum = a + b ，其中a来自A数组，b来自B数组，求 sum 中第k小的元素
    * */

    public int kthSmallestSum(int[] A, int[] B, int k) {
        PriorityQueue<int[]> p=new PriorityQueue<>((o1,o2)->{
            return o1[0]-o2[0];
        });
        int lengthA=A.length;
        int lengthB=B.length;
        p.add(new int[]{A[0]+B[0],0,0});
        Set<Long> reached=new HashSet<>();
        while(--k>0){
            int[] cur=p.poll();
            if(cur[1]<lengthA-1){
                int[] next=new int[]{A[cur[1]+1]+B[cur[2]],cur[1]+1,cur[2]};
                long flag=((long)(cur[1]+1))*lengthB+cur[2];
                if(!reached.contains(flag)) {
                    reached.add(flag);
                    p.add(next);
                }
            }
            if(cur[2]<lengthB-1){
                int[] next=new int[]{A[cur[1]]+B[cur[2]+1],cur[1],cur[2]+1};
                long flag = ((long)(cur[1]))*lengthB+cur[2]+1;
                if(!reached.contains(flag)){
                    reached.add(flag);
                    p.add(next);
                }
            }
        }
        return p.poll()[0];
        // write your code here
    }

    public static void main(String[] args){
        int[] a=new int[]{104,105,107,109,109,118,118,119,120,122,122,123,124,126,129,133,134,136,136,140,141,145,145,147,147,150,154,154,160,161,163,165,166,167,169,170,171,173,174,176,180,184,187,188,188,190,190,193,194,194,195,196,196,196,199,200,201,202,203,203,205,206,207,211,212,214,216,216,218,220,221,222,223,223,226,228,229,234,236,236,237,238,241,246,248,248,249,249,249,252,258,258,259,265,266,267,268,276,279,280,281,283,284,285,285,291,292,294,298,300,303,304,307,308,314,315,319,320,320,324,324,328,329,336,337,337,338,339,343,349,359,360,363,366,366,368,369,371,372,374,377,378,381,381,385,385,389,389,389,392,392,392,392,393,397,399,402,404,411,414,414,415,415,417,419,423,424,426,427,431,432,433,438,439,440,441,441,442,444,445,450,452,456,457,458,459,462,464,468,468,469,473,475,480,482,482,484,484,486,486,487,488,489,498,498,499,500,500,501,502,503,503,504,504,511,513,519,519,519,521,522,525,525,526,537,538,539,541,544,549,552,555,555,556,560,562,562,565,565,566,566,568,568,570,571,572,578,578,580,582,583,583,585,586,586,588,590,592,600,600,604,605,607,612,612,619,621,622,629,630,632,634,638,638,639,647,647,652,656,657,658,659,665,666,666,672,672,674,678,682,686,691,692,693,696,697,701,701,703,713,714,714,722,722,725,731,735,738,741,741,747,747,748,754,754,755,762,763,766,767,775,776,779,779,781,783,784,794,796,797,800,802,803,803,804,804,805,809,811,812,812,812,813,813,816,816,820,825,826,827,828,830,831,835,838,842,842,849,854,857,857,863,864,864,865,866,869,870,873,877,878,878,879,880,883,883,885,886,888,893,898,898,902,902,903,904,905,908,908,912,913,916,918,919,919,922,924,925,926,927,928,931,933,936,940,940,940,944,947,949,953,954,964,964,965,965,965,966,967,972,974,974,975,976,978,978,979,980,981,982,983,985,986,986,991,992,995,999,1005,1005,1007,1008,1011,1011,1011,1012,1013,1015,1017,1018,1020,1021,1022,1022,1023,1025,1026,1026,1031,1032,1032,1038,1041,1042,1046,1057,1057,1060,1064,1064,1067,1069,1071,1072,1072,1076,1078,1078,1078,1080,1081,1083,1088,1088,1096,1097,1097,1099,1100,1100,1103,1104,1104,1104,1105,1105,1106,1107,1108,1113,1116,1117,1121,1122,1124,1127,1129,1129,1135,1135,1135,1135,1136,1139,1140,1141,1141,1146,1147,1148,1153,1153,1154,1155,1156,1159,1160,1161,1161,1163,1163,1164,1166,1170,1171,1171,1172,1175,1177,1180,1180,1180,1180,1183,1183,1185,1186,1188,1189,1189,1191,1195,1199,1199,1207,1208,1208,1210,1211,1211,1213,1221,1221,1223,1224,1226,1226,1228,1230,1238,1242,1244,1249,1250,1252,1252,1253,1253,1257,1257,1262,1266,1270,1270,1271,1272,1273,1274,1274,1277,1278,1282,1283,1294,1295,1297,1299,1300,1301,1302,1306,1306,1309,1309,1310,1311,1312,1312,1313,1315,1317,1319,1322,1322,1324,1324,1326,1327,1330,1334,1335,1336,1338,1339,1342,1345,1347,1349,1351,1352,1353,1353,1355,1360,1363,1365,1365,1369,1369,1370,1370,1374,1376,1378,1378,1383,1383,1384,1385,1387,1388,1388,1388,1389,1393,1397,1402,1402,1404,1405,1406,1408,1408,1409,1411,1413,1413,1415,1415,1416,1416,1419,1423,1424,1427,1433,1434,1436,1438,1440,1442,1445,1446,1447,1450,1450,1452,1455,1455,1457,1461,1462,1465,1465,1466,1466,1469,1473,1477,1477,1479,1480,1481,1483,1483,1487,1488,1490,1493,1493,1498,1502,1503,1505,1509,1515,1518,1518,1519,1520,1521,1524,1524,1525,1534,1538,1538,1540,1541,1541,1544,1551,1554,1556,1558,1563,1567,1568,1571,1576,1579,1583,1583,1587,1587,1588,1590,1595,1598,1600,1601,1601,1610,1610,1610,1611,1612,1613,1614,1615,1616,1616,1617,1623,1623,1626,1630,1630,1632,1637,1637,1637,1638,1640,1641,1646,1652,1654,1656,1656,1657,1664,1664,1667,1669,1672,1672,1672,1674,1674,1679,1680,1683,1683,1685,1685,1686,1687,1689,1690,1692,1693,1695,1698,1699,1702,1702,1703,1705,1706,1712,1714,1718,1718,1721,1723,1726,1726,1728,1728,1729,1730,1730,1731,1733,1734,1736,1744,1746,1747,1750,1755,1761,1764,1765,1771,1772,1778,1780,1780,1781,1786,1789,1789,1789,1791,1792,1800,1800,1801,1801,1803,1806,1808,1810,1814,1826,1827,1827,1827,1831,1832,1833,1836,1843,1844,1851,1857,1858,1859,1861,1872,1872,1873,1875,1878,1880,1885,1886,1891,1894,1896,1898,1900,1901,1901,1905,1912,1912,1914,1914,1916,1920,1921,1925,1928,1928,1933,1934,1934,1935,1936,1937,1938,1938,1938,1940,1940,1943,1945,1948,1948,1950,1954,1955,1955,1959,1962,1965,1972,1974,1977,1979,1979,1981,1981,1985,1987,1989,1989,1990,1992,1996,1997,1999,1999,1999,2000};
        int[] b=new int[]{102,103,104,105,105,106,107,107,110,111,111,112,112,112,112,114,114,114,114,116,118,118,118,120,122,123,123,124,124,124,124,125,125,125,126,127,127,128,128,128,129,130,130,134,134,135,135,135,135,135,135,135,136,137,138,140,140,141,141,142,142,147,148,148,148,149,149,150,150,150,151,152,153,153,154,155,155,156,156,156,156,156,157,157,157,163,163,163,164,166,166,166,167,168,169,169,171,171,171,172,172,172,173,173,173,174,175,176,177,177,177,178,179,179,180,180,180,181,181,182,182,183,183,184,184,185,186,188,189,189,190,190,190,191,193,193,194,194,194,194,195,196,196,196,196,196,198,198,199,199,199,200,200,201,202,203,203,203,204,205,205,206,208,209,210,212,213,213,214,215,215,215,218,219,220,220,221,222,222,224,225,226,226,226,226,228,230,232,235,236,237,238,238,239,239,241,241,242,243,243,244,245,246,246,248,248,249,250,251,252,253,254,255,255,255,255,256,256,256,257,258,259,259,259,260,261,261,263,263,264,264,264,265,266,266,267,268,269,270,270,271,271,271,271,272,273,274,274,274,277,277,277,279,279,280,281,282,282,285,285,286,286,286,287,287,287,288,288,289,289,291,291,292,292,292,293,294,295,295,296,296,296,298,298,299,301,301,302,305,307,308,308,309,309,309,311,311,311,312,313,313,314,314,315,316,316,318,319,320,320,323,323,323,324,325,326,328,329,329,330,330,331,333,333,333,334,335,336,337,337,338,339,339,340,341,343,343,345,345,346,346,347,347,348,348,348,348,350,350,351,351,352,353,354,354,354,355,356,359,359,359,361,362,363,364,364,366,367,367,367,370,371,372,374,375,375,375,375,376,376,376,376,377,378,379,383,384,385,385,387,389,389,390,390,391,391,392,392,392,393,394,394,394,394,395,395,395,396,396,397,397,397,397,400,400,401,401,401,402,403,403,404,404,405,409,409,410,411,411,412,412,413,414,415,415,415,415,416,419,419,420,420,421,423,423,423,426,428,428,429,429,429,429,429,430,431,431,433,434,434,434,434,436,437,437,437,439,442,442,443,444,444,446,446,446,447,448,449,449,449,451,452,452,452,452,453,453,453,453,454,455,456,456,456,457,457,458,458,458,459,460,460,461,462,464,464,464,466,466,466,467,467,467,469,469,471,471,471,472,473,474,475,476,477,477,477,477,477,478,481,482,482,483,483,485,485,486,487,488,489,490,491,493,494,494,495,495,496,497,500,500,501,501,502,503,503,504,505,505,505,507,508,508,508,509,511,511,511,513,513,514,514,515,515,515,515,517,517,518,520,523,523,527,528,528,530,531,533,533,533,533,533,535,536,536,537,537,538,538,539,541,541,542,542,544,545,545,545,546,546,546,547,547,547,548,548,548,548,548,549,549,550,550,550,550,551,551,551,552,552,554,556,556,556,556,557,557,557,558,559,560,561,562,562,563,565,565,566,567,570,570,572,573,573,574,574,576,576,576,577,578,579,580,582,582,582,583,583,583,583,584,584,585,586,586,587,587,589,590,592,592,593,594,595,596,596,596,597,597,597,598,598,598,598,599,600,602,604,605,606,606,606,606,607,608,608,608,608,610,611,612,613,613,614,615,615,615,617,618,619,619,620,622,623,623,623,624,625,626,626,627,627,627,627,628,629,630,630,630,631,631,632,632,633,634,634,636,637,637,638,641,642,643,644,644,644,645,646,648,649,649,650,653,654,655,655,655,655,656,657,657,658,659,659,660,660,660,661,662,662,662,662,662,664,664,664,664,665,665,666,667,667,667,668,668,668,668,669,671,672,672,673,674,674,674,674,675,676,676,677,677,678,680,680,681,681,681,681,682,682,682,683,683,684,684,684,686,689,689,689,690,692,694,694,695,695,695,697,698,698,698,700,700,700,700,702,702,703,703,707,707,708,709,710,711,711,712,712,712,714,716,716,716,717,718,720,720,721,721,721,722,722,722,722,723,723,723,723,724,724,724,725,725,725,728,729,729,730,730,730,731,732,732,735,736,736,737,737,738,738,739,740,742,743,743,745,745,746,747,747,748,748,750,750,751,752,752,753,754,755,757,758,758,758,759,761,761,761,762,763,763,763,764,764,767,767,768,768,768,768,769,769,769,769,770,770,770,770,771,772,774,774,776,777,777,779,780,780,780,783,785,786,787,787,787,790,790,792,794,794,794,794,795,796,796,796,798,798,799,800,801,802,802,802,803,803,804,805,805,806,808,809,810,810,810,811,811,813,813,814,814,815,816,817,817,817,817,819,819,820,821,823,823,823,824,825,826,827,827,829,829,830,833,833,833,833,834,835,837,838,841,841,842,842,843,843,843,843,843,844,844,844,845,845,846,846,847,847,847,847,849,854,855,856,857,858,859,859,860,862,863,863,864,864,867,868,869,869,870,870,872,872,873,873,873,874,875,875,875,877,878,878,879,879,879,880,880,881,881,881,882,882,882,882,882,885,887,887,889,889,890,893,895,895,895,896,896,896,897,897,898,899,899,899,899,899,900,901,901,901,902,903,903,904,908,909,909,910,910,910,911,912,913,916,916,918,918,919,919,919,920,922,923,923,923,923,923,924,924,924,925,926,926,927,927,927,929,929,930,931,933,934,935,935,936,938,938,938,938,939,940,941,941,942,943,944,946,946,947,947,949,950,950,950,951,952,952,953,956,956,956,957,957,958,959,959,959,959,960,960,961,961,961,962,963,963,964,965,965,966,966,968,970,971,972,972,972,975,976,976,978,979,980,980,980,981,982,983,983,983,983,984,985,987,987,989,990,991,991,991,992,992,993,993,996,996};
        int c=248657;
        System.out.println(new LINTCODE465().kthSmallestSum(a,b,c));
    }
}
